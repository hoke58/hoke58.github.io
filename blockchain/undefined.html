<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#45b29a">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="https://upyun.hoke58.cn/hoke/120.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://upyun.hoke58.cn/hoke/32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://upyun.hoke58.cn/hoke/16.png">
  <link rel="mask-icon" href="https://upyun.hoke58.cn/hoke/me.svg" color="#45b29a">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="google-site-verification" content="6M1tNsOwqP0HQYRu05OoRnwMrHht_QPFtI9zWYEXKwE">
  <meta name="msvalidate.01" content="1E797E0277F06EFAFDD1B8812239CBF1">
  <meta name="baidu-site-verification" content="CGRbkP3WuK">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.proxy.ustclug.org/css?family=Noto Serif TC:300,300italic,400,400italic,700,700italic|Rock Salt:300,300italic,400,400italic,700,700italic|Noto Sans TC:300,300italic,400,400italic,700,700italic|Noto Serif SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.hoke58.cn","root":"/","scheme":"Mist","version":"7.7.2","exturl":true,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":true,"color":"#45b29a","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="CHFA 介绍CHFA （Certified Hyperledger Fabric Administrator）是 Linux 基金会发放的认证证书，按照官方的说法，获得此证书的人，具备搭建一个安全的可商用的 Hyperledger Fabric 网络的能力，其中包括对网络的节点进行安装、配置、操作、管理和排错的能力。 证书有效期为 2 年，考试费 300 美刀，报名有效期为 12 个月，考试形式">
<meta property="og:type" content="article">
<meta property="og:title" content="Certified Hyperledger Fabric Administrator（CHFA）备考笔记">
<meta property="og:url" content="https://blog.hoke58.cn/blockchain/undefined.html">
<meta property="og:site_name" content="Hoke&#39;s blog">
<meta property="og:description" content="CHFA 介绍CHFA （Certified Hyperledger Fabric Administrator）是 Linux 基金会发放的认证证书，按照官方的说法，获得此证书的人，具备搭建一个安全的可商用的 Hyperledger Fabric 网络的能力，其中包括对网络的节点进行安装、配置、操作、管理和排错的能力。 证书有效期为 2 年，考试费 300 美刀，报名有效期为 12 个月，考试形式">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://upyun.hoke58.cn/img/CHFA-20200430163026.png">
<meta property="og:image" content="https://upyun.hoke58.cn/img/CHFA-CHFA.png">
<meta property="article:published_time" content="2020-04-30T10:39:05.000Z">
<meta property="article:modified_time" content="2020-04-30T10:03:09.202Z">
<meta property="article:author" content="Hoke">
<meta property="article:tag" content="Hyperledger">
<meta property="article:tag" content="CHFA">
<meta property="article:tag" content="Fabric">
<meta property="article:tag" content="fabric-ca">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://upyun.hoke58.cn/img/CHFA-20200430163026.png">

<link rel="canonical" href="https://blog.hoke58.cn/blockchain/undefined.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>Certified Hyperledger Fabric Administrator（CHFA）备考笔记 | Hoke's blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-154875719-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-154875719-1');
      }
    </script>


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?a747a691426f25a8eddbceef7187a30f";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hoke's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <h1 class="site-subtitle" itemprop="description">何可的博客</h1>
      
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-cloud">

    <span class="exturl" data-url="aHR0cHM6Ly9wYW4uaG9rZTU4LmNu"><i class="fa fa-fw fa-cloud"></i>云盘</span>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.hoke58.cn/blockchain/undefined.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://upyun.hoke58.cn/hoke/hoke_avatar.png">
      <meta itemprop="name" content="Hoke">
      <meta itemprop="description" content="一名追求简单实用的运维开发工程师">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hoke's blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          Certified Hyperledger Fabric Administrator（CHFA）备考笔记
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-04-30 18:39:05 / 修改时间：18:03:09" itemprop="dateCreated datePublished" datetime="2020-04-30T18:39:05+08:00">2020-04-30</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/blockchain/" itemprop="url" rel="index"><span itemprop="name">区块链</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/blockchain/undefined.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/blockchain/undefined.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>31k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>28 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="CHFA-介绍"><a href="#CHFA-介绍" class="headerlink" title="CHFA 介绍"></a>CHFA 介绍</h1><p>CHFA （Certified Hyperledger Fabric Administrator）是 Linux 基金会发放的认证证书，按照官方的说法，获得此证书的人，具备搭建一个安全的可商用的 Hyperledger Fabric 网络的能力，其中包括对网络的节点进行安装、配置、操作、管理和排错的能力。</p>
<p>证书有效期为 2 年，考试费 300 美刀，报名有效期为 12 个月，考试形式为在线考，考试时长2小时，我考试时的 Fabric 版本 1.4.1</p>
<p>考试结束后 36小 时可以官网 My Portal 看到成绩</p>
<a id="more"></a>

<p><img src="https://upyun.hoke58.cn/img/CHFA-20200430163026.png" alt="CHFA-20200430163026"></p>
<h1 id="备考笔记"><a href="#备考笔记" class="headerlink" title="备考笔记"></a>备考笔记</h1><p><img src="https://upyun.hoke58.cn/img/CHFA-CHFA.png" alt="CHFA-CHFA"></p>
<h2 id="Application-Lifecycle-Management-–-20"><a href="#Application-Lifecycle-Management-–-20" class="headerlink" title="Application Lifecycle Management – 20%"></a>Application Lifecycle Management – 20%</h2><h3 id="Install-and-Instantiate-chaincode-package"><a href="#Install-and-Instantiate-chaincode-package" class="headerlink" title="Install and Instantiate chaincode package"></a>Install and Instantiate chaincode package</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">peer chaincode install -n mycc -v <span class="variable">$&#123;VERSION&#125;</span> -l <span class="variable">$&#123;LANGUAGE&#125;</span> -p <span class="variable">$&#123;CC_SRC_PATH&#125;</span></span><br><span class="line"><span class="comment"># go env</span></span><br><span class="line">peer chaincode  install -n mycc -v 1.0 -p github.com/chaincode/chaincode_example02/go/</span><br><span class="line">peer chaincode instantiate -o orderer.example.com:7050 --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C <span class="variable">$CHANNEL_NAME</span> -n mycc -v 1.0 -c <span class="string">'&#123;"Args":["init","a", "100", "b","200"]&#125;'</span> -P <span class="string">"AND ('Org1MSP.peer','Org2MSP.peer')"</span></span><br><span class="line"><span class="comment"># node</span></span><br><span class="line">peer chaincode install -n nodecc -v 1.0 -l node -p /opt/gopath/src/github.com/chaincode/chaincode_example02/node/</span><br><span class="line">peer chaincode instantiate -o orderer.example.com:7050 --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C <span class="variable">$CHANNEL_NAME</span> -n mycc -l node -v 1.0 -c <span class="string">'&#123;"Args":["init","a", "100", "b","200"]&#125;'</span> -P <span class="string">"AND ('Org1MSP.peer','Org2MSP.peer')"</span></span><br><span class="line"><span class="comment"># java</span></span><br><span class="line">peer chaincode install -n javacc -v 1.0 -l java -p /opt/gopath/src/github.com/chaincode/chaincode_example02/java/</span><br><span class="line">peer chaincode instantiate -o orderer.example.com:7050 --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C <span class="variable">$CHANNEL_NAME</span> -n mycc -l java -v 1.0 -c <span class="string">'&#123;"Args":["init","a", "100", "b","200"]&#125;'</span> -P <span class="string">"AND ('Org1MSP.peer','Org2MSP.peer')"</span></span><br><span class="line"></span><br><span class="line">peer chaincode package -n mycc -p github.com/chaincode/chaincode_example02/go -v 1.1 mycc-1.1.out</span><br></pre></td></tr></table></figure>
<h3 id="Configure-endorsement-policy"><a href="#Configure-endorsement-policy" class="headerlink" title="Configure endorsement policy"></a>Configure endorsement policy</h3><p>参上</p>
<h3 id="Define-collection-policy-for-private-data"><a href="#Define-collection-policy-for-private-data" class="headerlink" title="Define collection policy for private data"></a>Define collection policy for private data</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9oeXBlcmxlZGdlci1mYWJyaWMucmVhZHRoZWRvY3MuaW8vZW4vcmVsZWFzZS0xLjQvcHJpdmF0ZV9kYXRhX3R1dG9yaWFsLmh0bWw=" title="https://hyperledger-fabric.readthedocs.io/en/release-1.4/private_data_tutorial.html">Docs » Tutorials » Using Private Data in Fabric<i class="fa fa-external-link"></i></span><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="attr">"name"</span>: <span class="string">"collectionMarbles"</span>,</span><br><span class="line">    <span class="attr">"policy"</span>: <span class="string">"OR('Org1MSP.member', 'Org2MSP.member')"</span>,</span><br><span class="line">    <span class="attr">"requiredPeerCount"</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">"maxPeerCount"</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="attr">"blockToLive"</span>:<span class="number">1000000</span>,</span><br><span class="line">    <span class="attr">"memberOnlyRead"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"memberOnlyWrite"</span>: <span class="literal">true</span></span><br><span class="line"> &#125;,</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="attr">"name"</span>: <span class="string">"collectionMarblePrivateDetails"</span>,</span><br><span class="line">    <span class="attr">"policy"</span>: <span class="string">"OR('Org1MSP.member')"</span>,</span><br><span class="line">    <span class="attr">"requiredPeerCount"</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">"maxPeerCount"</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="attr">"blockToLive"</span>:<span class="number">3</span>,</span><br><span class="line">    <span class="attr">"memberOnlyRead"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"memberOnlyWrite"</span>:<span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"endorsementPolicy"</span>: &#123;</span><br><span class="line">      <span class="attr">"signaturePolicy"</span>: <span class="string">"OR('Org1MSP.member')"</span></span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">peer chaincode instantiate -o orderer.example.com:7050 --tls --cafile <span class="variable">$ORDERER_CA</span> -C mychannel -n marblesp -v 1.0 -c <span class="string">'&#123;"Args":["init"]&#125;'</span> -P <span class="string">"OR('Org1MSP.member','Org2MSP.member')"</span> --collections-config  <span class="variable">$GOPATH</span>/src/github.com/chaincode/marbles02_private/collections_config.json</span><br></pre></td></tr></table></figure>
<h3 id="Modify-or-upgrade-chaincode"><a href="#Modify-or-upgrade-chaincode" class="headerlink" title="Modify or upgrade chaincode"></a>Modify or upgrade chaincode</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">peer chaincode upgrade -o orderer.example.com:7050 --tls <span class="variable">$CORE_PEER_TLS_ENABLED</span> --cafile <span class="variable">$ORDERER_CA</span> -C <span class="variable">$CHANNEL_NAME</span> -n mycc -v 2.0 -c <span class="string">'&#123;"Args":["init","a","90","b","210"]&#125;'</span> -P <span class="string">"OR ('Org1MSP.peer','Org2MSP.peer','Org3MSP.peer')"</span></span><br></pre></td></tr></table></figure>
<h2 id="Install-and-Configure-Network-–-25"><a href="#Install-and-Configure-Network-–-25" class="headerlink" title="Install and Configure Network – 25%"></a>Install and Configure Network – 25%</h2></li>
</ul>
<h3 id="Modify-the-world-state-database-configuration"><a href="#Modify-the-world-state-database-configuration" class="headerlink" title="Modify the world state database configuration"></a>Modify the world state database configuration</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9oeXBlcmxlZGdlci1mYWJyaWMucmVhZHRoZWRvY3MuaW8vZW4vcmVsZWFzZS0xLjQvY291Y2hkYl90dXRvcmlhbC5odG1s" title="https://hyperledger-fabric.readthedocs.io/en/release-1.4/couchdb_tutorial.html">Docs » Tutorials » Using CouchDB<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9oeXBlcmxlZGdlci1mYWJyaWMucmVhZHRoZWRvY3MuaW8vZW4vcmVsZWFzZS0xLjQvY291Y2hkYl9hc19zdGF0ZV9kYXRhYmFzZS5odG1s" title="https://hyperledger-fabric.readthedocs.io/en/release-1.4/couchdb_as_state_database.html">Docs » Architecture Reference » CouchDB as the State Database<i class="fa fa-external-link"></i></span></li>
</ul>
<ol>
<li>Enable CouchDB in Hyperledger Fabric</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#	COUCHDB_USER COUCHDB_PASSWORD 管理员用户名和密码，不填的话couchDB会采用"Admin Party"模式，即所有人做任何事</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  couchdb0:</span></span><br><span class="line"><span class="attr">    container_name:</span> <span class="string">couchdb0</span></span><br><span class="line"><span class="attr">    image:</span> <span class="string">hyperledger/fabric-couchdb</span></span><br><span class="line"><span class="attr">    environment:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">COUCHDB_USER=</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">COUCHDB_PASSWORD=</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"5984:5984"</span></span><br><span class="line"><span class="attr">    networks:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">byfn</span></span><br><span class="line"></span><br><span class="line">  <span class="string">peer0.org1.example.com:</span></span><br><span class="line"><span class="attr">    environment:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_LEDGER_STATE_STATEDATABASE=CouchDB</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_LEDGER_STATE_COUCHDBCONFIG_COUCHDBADDRESS=couchdb0:5984</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_LEDGER_STATE_COUCHDBCONFIG_USERNAME=</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_LEDGER_STATE_COUCHDBCONFIG_PASSWORD=</span></span><br><span class="line"><span class="attr">    depends_on:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">couchdb0</span></span><br></pre></td></tr></table></figure>
<p>couchdb页面访问 <span class="exturl" data-url="aHR0cDovL2lwOjU5ODQvX3V0aWxzLw==" title="http://ip:5984/_utils/">http://ip:5984/_utils/<i class="fa fa-external-link"></i></span></p>
<ol start="2">
<li>Create an index<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"index"</span>: &#123;</span><br><span class="line">        <span class="attr">"fields"</span>: [<span class="string">"foo"</span>]  // these are the frequently queried fields</span><br><span class="line">    &#125;,</span><br><span class="line">    "name" : "foo-index",  // name of the index</span><br><span class="line">    "type" : "json"  // always json in this context</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>Marbles sample:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"index"</span>:&#123;</span><br><span class="line">      <span class="attr">"fields"</span>:[<span class="string">"docType"</span>,<span class="string">"owner"</span>] // Names of the fields to be queried</span><br><span class="line">  &#125;,</span><br><span class="line">  "ddoc":"indexOwnerDoc", // (optional) Name of the design document in which the index will be created.</span><br><span class="line">  "name":"indexOwner",</span><br><span class="line">  "type":"json"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>index files must be located under the path <code>META-INF/statedb/couchdb/indexes</code> which is located inside the directory where the chaincode resides</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"index"</span>:&#123;<span class="attr">"fields"</span>:[<span class="string">"docType"</span>,<span class="string">"owner"</span>]&#125;,<span class="attr">"ddoc"</span>:<span class="string">"indexOwnerDoc"</span>, <span class="attr">"name"</span>:<span class="string">"indexOwner"</span>,<span class="attr">"type"</span>:<span class="string">"json"</span>&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Define-initial-multi-org-configuration-policy"><a href="#Define-initial-multi-org-configuration-policy" class="headerlink" title="Define initial multi-org configuration policy"></a>Define initial multi-org configuration policy</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Organizations:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="meta">&amp;OrdererOrg</span></span><br><span class="line"><span class="attr">        Name:</span> <span class="string">OrdererOrg</span></span><br><span class="line"><span class="attr">        ID:</span> <span class="string">OrdererMSP</span></span><br><span class="line"><span class="attr">        MSPDir:</span> <span class="string">crypto-config/ordererOrganizations/example.com/msp</span></span><br><span class="line"><span class="attr">        Policies:</span></span><br><span class="line"><span class="attr">            Readers:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('OrdererMSP.member')"</span></span><br><span class="line"><span class="attr">            Writers:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('OrdererMSP.member')"</span></span><br><span class="line"><span class="attr">            Admins:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('OrdererMSP.admin')"</span></span><br><span class="line"><span class="bullet">    -</span> <span class="meta">&amp;Org1</span></span><br><span class="line"><span class="attr">        Name:</span> <span class="string">Org1MSP</span></span><br><span class="line"><span class="attr">        ID:</span> <span class="string">Org1MSP</span></span><br><span class="line"><span class="attr">        MSPDir:</span> <span class="string">crypto-config/peerOrganizations/org1.example.com/msp</span></span><br><span class="line"><span class="attr">        Policies:</span></span><br><span class="line"><span class="attr">            Readers:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('Org1MSP.admin', 'Org1MSP.peer', 'Org1MSP.client')"</span></span><br><span class="line"><span class="attr">            Writers:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('Org1MSP.admin', 'Org1MSP.client')"</span></span><br><span class="line"><span class="attr">            Admins:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('Org1MSP.admin')"</span></span><br><span class="line"><span class="attr">        AnchorPeers:</span></span><br><span class="line"><span class="attr">            - Host:</span> <span class="string">peer0.org1.example.com</span></span><br><span class="line"><span class="attr">              Port:</span> <span class="number">7051</span></span><br><span class="line"><span class="bullet">    -</span> <span class="meta">&amp;Org2</span></span><br><span class="line"><span class="attr">        Name:</span> <span class="string">Org2MSP</span></span><br><span class="line"><span class="attr">        ID:</span> <span class="string">Org2MSP</span></span><br><span class="line"><span class="attr">        MSPDir:</span> <span class="string">crypto-config/peerOrganizations/org2.example.com/msp</span></span><br><span class="line"><span class="attr">        Policies:</span></span><br><span class="line"><span class="attr">            Readers:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('Org2MSP.admin', 'Org2MSP.peer', 'Org2MSP.client')"</span></span><br><span class="line"><span class="attr">            Writers:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('Org2MSP.admin', 'Org2MSP.client')"</span></span><br><span class="line"><span class="attr">            Admins:</span></span><br><span class="line"><span class="attr">                Type:</span> <span class="string">Signature</span></span><br><span class="line"><span class="attr">                Rule:</span> <span class="string">"OR('Org2MSP.admin')"</span></span><br><span class="line"><span class="attr">        AnchorPeers:</span></span><br><span class="line"><span class="attr">            - Host:</span> <span class="string">peer0.org2.example.com</span></span><br><span class="line"><span class="attr">              Port:</span> <span class="number">9051</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="attr">Profiles:</span></span><br><span class="line"><span class="attr">    TwoOrgsOrdererGenesis:</span></span><br><span class="line">        <span class="string">&lt;&lt;:</span> <span class="meta">*ChannelDefaults</span></span><br><span class="line"><span class="attr">        Orderer:</span></span><br><span class="line">            <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererDefaults</span></span><br><span class="line"><span class="attr">            Organizations:</span></span><br><span class="line"><span class="bullet">                -</span> <span class="meta">*OrdererOrg</span></span><br><span class="line"><span class="attr">            Capabilities:</span></span><br><span class="line">                <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererCapabilities</span></span><br><span class="line"><span class="attr">        Consortiums:</span></span><br><span class="line"><span class="attr">            SampleConsortium:</span></span><br><span class="line"><span class="attr">                Organizations:</span></span><br><span class="line"><span class="bullet">                    -</span> <span class="meta">*Org1</span></span><br><span class="line"><span class="bullet">                    -</span> <span class="meta">*Org2</span></span><br><span class="line"><span class="attr">    TwoOrgsChannel:</span></span><br><span class="line"><span class="attr">        Consortium:</span> <span class="string">SampleConsortium</span></span><br><span class="line">        <span class="string">&lt;&lt;:</span> <span class="meta">*ChannelDefaults</span></span><br><span class="line"><span class="attr">        Application:</span></span><br><span class="line">            <span class="string">&lt;&lt;:</span> <span class="meta">*ApplicationDefaults</span></span><br><span class="line"><span class="attr">            Organizations:</span></span><br><span class="line"><span class="bullet">                -</span> <span class="meta">*Org1</span></span><br><span class="line"><span class="bullet">                -</span> <span class="meta">*Org2</span></span><br><span class="line"><span class="attr">            Capabilities:</span></span><br><span class="line">                <span class="string">&lt;&lt;:</span> <span class="meta">*ApplicationCapabilities</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    SampleDevModeKafka:</span></span><br><span class="line">        <span class="string">&lt;&lt;:</span> <span class="meta">*ChannelDefaults</span></span><br><span class="line"><span class="attr">        Capabilities:</span></span><br><span class="line">            <span class="string">&lt;&lt;:</span> <span class="meta">*ChannelCapabilities</span></span><br><span class="line"><span class="attr">        Orderer:</span></span><br><span class="line">            <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererDefaults</span></span><br><span class="line"><span class="attr">            OrdererType:</span> <span class="string">kafka</span></span><br><span class="line"><span class="attr">            Kafka:</span></span><br><span class="line"><span class="attr">                Brokers:</span></span><br><span class="line"><span class="bullet">                -</span> <span class="string">kafka.example.com:9092</span></span><br><span class="line"></span><br><span class="line"><span class="attr">            Organizations:</span></span><br><span class="line"><span class="bullet">            -</span> <span class="meta">*OrdererOrg</span></span><br><span class="line"><span class="attr">            Capabilities:</span></span><br><span class="line">                <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererCapabilities</span></span><br><span class="line"><span class="attr">        Application:</span></span><br><span class="line">            <span class="string">&lt;&lt;:</span> <span class="meta">*ApplicationDefaults</span></span><br><span class="line"><span class="attr">            Organizations:</span></span><br><span class="line"><span class="bullet">            -</span> <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererOrg</span></span><br><span class="line"><span class="attr">        Consortiums:</span></span><br><span class="line"><span class="attr">            SampleConsortium:</span></span><br><span class="line"><span class="attr">                Organizations:</span></span><br><span class="line"><span class="bullet">                -</span> <span class="meta">*Org1</span></span><br><span class="line"><span class="bullet">                -</span> <span class="meta">*Org2</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    SampleMultiNodeEtcdRaft:</span></span><br><span class="line">        <span class="string">&lt;&lt;:</span> <span class="meta">*ChannelDefaults</span></span><br><span class="line"><span class="attr">        Capabilities:</span></span><br><span class="line">            <span class="string">&lt;&lt;:</span> <span class="meta">*ChannelCapabilities</span></span><br><span class="line"><span class="attr">        Orderer:</span></span><br><span class="line">            <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererDefaults</span></span><br><span class="line"><span class="attr">            OrdererType:</span> <span class="string">etcdraft</span></span><br><span class="line"><span class="attr">            EtcdRaft:</span></span><br><span class="line"><span class="attr">                Consenters:</span></span><br><span class="line"><span class="attr">                - Host:</span> <span class="string">orderer.example.com</span></span><br><span class="line"><span class="attr">                  Port:</span> <span class="number">7050</span></span><br><span class="line"><span class="attr">                  ClientTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer.example.com/tls/server.crt</span></span><br><span class="line"><span class="attr">                  ServerTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer.example.com/tls/server.crt</span></span><br><span class="line"><span class="attr">                - Host:</span> <span class="string">orderer2.example.com</span></span><br><span class="line"><span class="attr">                  Port:</span> <span class="number">7050</span></span><br><span class="line"><span class="attr">                  ClientTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer2.example.com/tls/server.crt</span></span><br><span class="line"><span class="attr">                  ServerTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer2.example.com/tls/server.crt</span></span><br><span class="line"><span class="attr">                - Host:</span> <span class="string">orderer3.example.com</span></span><br><span class="line"><span class="attr">                  Port:</span> <span class="number">7050</span></span><br><span class="line"><span class="attr">                  ClientTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer3.example.com/tls/server.crt</span></span><br><span class="line"><span class="attr">                  ServerTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer3.example.com/tls/server.crt</span></span><br><span class="line"><span class="attr">                - Host:</span> <span class="string">orderer4.example.com</span></span><br><span class="line"><span class="attr">                  Port:</span> <span class="number">7050</span></span><br><span class="line"><span class="attr">                  ClientTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer4.example.com/tls/server.crt</span></span><br><span class="line"><span class="attr">                  ServerTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer4.example.com/tls/server.crt</span></span><br><span class="line"><span class="attr">                - Host:</span> <span class="string">orderer5.example.com</span></span><br><span class="line"><span class="attr">                  Port:</span> <span class="number">7050</span></span><br><span class="line"><span class="attr">                  ClientTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer5.example.com/tls/server.crt</span></span><br><span class="line"><span class="attr">                  ServerTLSCert:</span> <span class="string">crypto-config/ordererOrganizations/example.com/orderers/orderer5.example.com/tls/server.crt</span></span><br><span class="line"><span class="attr">            Addresses:</span></span><br><span class="line"><span class="bullet">                -</span> <span class="string">orderer.example.com:7050</span></span><br><span class="line"><span class="bullet">                -</span> <span class="string">orderer2.example.com:7050</span></span><br><span class="line"><span class="bullet">                -</span> <span class="string">orderer3.example.com:7050</span></span><br><span class="line"><span class="bullet">                -</span> <span class="string">orderer4.example.com:7050</span></span><br><span class="line"><span class="bullet">                -</span> <span class="string">orderer5.example.com:7050</span></span><br><span class="line"></span><br><span class="line"><span class="attr">            Organizations:</span></span><br><span class="line"><span class="bullet">            -</span> <span class="meta">*OrdererOrg</span></span><br><span class="line"><span class="attr">            Capabilities:</span></span><br><span class="line">                <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererCapabilities</span></span><br><span class="line"><span class="attr">        Application:</span></span><br><span class="line">            <span class="string">&lt;&lt;:</span> <span class="meta">*ApplicationDefaults</span></span><br><span class="line"><span class="attr">            Organizations:</span></span><br><span class="line"><span class="bullet">            -</span> <span class="string">&lt;&lt;:</span> <span class="meta">*OrdererOrg</span></span><br><span class="line"><span class="attr">        Consortiums:</span></span><br><span class="line"><span class="attr">            SampleConsortium:</span></span><br><span class="line"><span class="attr">                Organizations:</span></span><br><span class="line"><span class="bullet">                -</span> <span class="meta">*Org1</span></span><br><span class="line"><span class="bullet">                -</span> <span class="meta">*Org2</span></span><br></pre></td></tr></table></figure>

<h3 id="Configure-Ordering-service-Kafka"><a href="#Configure-Ordering-service-Kafka" class="headerlink" title="Configure Ordering service (Kafka)"></a>Configure Ordering service (Kafka)</h3><ul>
<li><code>Orderer.OrdererType</code> is set to <code>kafka</code></li>
<li><code>Orderer.Kafka.Brokers</code></li>
<li><code>Orderer.AbsoluteMaxBytes</code></li>
</ul>
<p>kafka</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">KAFKA_UNCLEAN_LEADER_ELECTION_ENABLE=false</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">KAFKA_MIN_INSYNC_REPLICAS=1</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">KAFKA_DEFAULT_REPLICATION_FACTOR=1</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">KAFKA_MESSAGE_MAX_BYTES=1048576</span> <span class="comment"># 1 * 1024 * 1024 B</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">KAFKA_REPLICA_FETCH_MAX_BYTES=1048576</span> <span class="comment"># 1 * 1024 * 1024 B</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">KAFKA_LOG_RETENTION_MS=-1</span></span><br></pre></td></tr></table></figure>
<p>orderer</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_KAFKA_TOPIC_REPLICATIONFACTOR=1</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_KAFKA_VERBOSE=true</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_KAFKA_TLS_ENABLED=true</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_KAFKA_TLS_PRIVATEKEY_FILE=/var/hyperledger/orderer/kafka/tls/client.key</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_KAFKA_TLS_CERTIFICATE_FILE=/var/hyperledger/orderer/kafka/tls/client.crt</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_KAFKA_TLS_ROOTCAS_FILE=/var/hyperledger/orderer/kafka/tls/ca.crt</span></span><br></pre></td></tr></table></figure>
<h3 id="Configure-Hyperledger-Fabric-containers"><a href="#Configure-Hyperledger-Fabric-containers" class="headerlink" title="Configure Hyperledger Fabric containers"></a>Configure Hyperledger Fabric containers</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  peer-base:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="string">hyperledger/fabric-peer:$IMAGE_TAG</span></span><br><span class="line"><span class="attr">    environment:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</span></span><br><span class="line">      <span class="comment"># the following setting starts chaincode containers on the same</span></span><br><span class="line">      <span class="comment"># bridge network as the peers</span></span><br><span class="line">      <span class="comment"># https://docs.docker.com/compose/networking/</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=$&#123;COMPOSE_PROJECT_NAME&#125;_byfn</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">FABRIC_LOGGING_SPEC=INFO</span></span><br><span class="line">      <span class="comment">#- FABRIC_LOGGING_SPEC=DEBUG</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_TLS_ENABLED=true</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_GOSSIP_USELEADERELECTION=true</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_GOSSIP_ORGLEADER=false</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_PROFILE_ENABLED=true</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_ID=peer0.org1.example.com</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_ADDRESS=peer0.org1.example.com:7051</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_LISTENADDRESS=0.0.0.0:7051</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_CHAINCODEADDRESS=peer0.org1.example.com:7052</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_GOSSIP_BOOTSTRAP=peer1.org1.example.com:8051</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.org1.example.com:7051</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">CORE_PEER_LOCALMSPID=Org1MSP</span></span><br><span class="line"><span class="attr">    working_dir:</span> <span class="string">/opt/gopath/src/github.com/hyperledger/fabric/peer</span></span><br><span class="line"><span class="attr">    command:</span> <span class="string">peer</span> <span class="string">node</span> <span class="string">start</span></span><br><span class="line"></span><br><span class="line"><span class="attr">  orderer-base:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="string">hyperledger/fabric-orderer:$IMAGE_TAG</span></span><br><span class="line"><span class="attr">    environment:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">FABRIC_LOGGING_SPEC=DEBUG</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_LISTENADDRESS=0.0.0.0</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_GENESISMETHOD=file</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_LOCALMSPID=OrdererMSP</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp</span></span><br><span class="line">      <span class="comment"># enabled TLS</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_TLS_ENABLED=true</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">ORDERER_KAFKA_TOPIC_REPLICATIONFACTOR=1</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">ORDERER_KAFKA_VERBOSE=true</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_CLUSTER_CLIENTCERTIFICATE=/var/hyperledger/orderer/tls/server.crt</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_CLUSTER_CLIENTPRIVATEKEY=/var/hyperledger/orderer/tls/server.key</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">ORDERER_GENERAL_CLUSTER_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]</span></span><br><span class="line"><span class="attr">    working_dir:</span> <span class="string">/opt/gopath/src/github.com/hyperledger/fabric</span></span><br><span class="line"><span class="attr">    command:</span> <span class="string">orderer</span></span><br></pre></td></tr></table></figure>
<h3 id="Define-network-config-options-block-creation-options-etc"><a href="#Define-network-config-options-block-creation-options-etc" class="headerlink" title="Define network config options (block creation options, etc)"></a>Define network config options (block creation options, etc)</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9oeXBlcmxlZGdlci1mYWJyaWMucmVhZHRoZWRvY3MuaW8vZW4vcmVsZWFzZS0xLjQvY29uZmlnX3VwZGF0ZS5odG1sI2VkaXRpbmctYS1jb25maWc=" title="https://hyperledger-fabric.readthedocs.io/en/release-1.4/config_update.html#editing-a-config">Docs » Operations Guides » Updating a Channel Configuration<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9oeXBlcmxlZGdlci1mYWJyaWMucmVhZHRoZWRvY3MuaW8vZW4vcmVsZWFzZS0xLjQvY2hhbm5lbF91cGRhdGVfdHV0b3JpYWwuaHRtbA==" title="https://hyperledger-fabric.readthedocs.io/en/release-1.4/channel_update_tutorial.html">Docs » Tutorials » Adding an Org to a Channel<i class="fa fa-external-link"></i></span></li>
</ul>
<p>configtx.yaml</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"Orderer.BatchSize.absolute_max_bytes"</span>: <span class="number">102760448</span>,</span><br><span class="line">  <span class="attr">"Orderer.BatchSize.max_message_count"</span>: <span class="number">10</span>,</span><br><span class="line">  <span class="attr">"Orderer.BatchSize.preferred_max_bytes"</span>: <span class="number">524288</span>,</span><br><span class="line">  <span class="attr">"Orderer.BatchTimeout"</span>: <span class="string">"2s"</span>,</span><br><span class="line">  "Orderer.MaxChannels": "1000", // defautl set 0 , this implies no maximum number of channels</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Enable-TLS-for-communication"><a href="#Enable-TLS-for-communication" class="headerlink" title="Enable TLS for communication"></a>Enable TLS for communication</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9oeXBlcmxlZGdlci1mYWJyaWMucmVhZHRoZWRvY3MuaW8vZW4vcmVsZWFzZS0xLjQvZW5hYmxlX3Rscy5odG1s" title="https://hyperledger-fabric.readthedocs.io/en/release-1.4/enable_tls.html">Docs » Operations Guides » Securing Communication With Transport Layer Security (TLS)<i class="fa fa-external-link"></i></span></li>
</ul>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># orderer </span></span><br><span class="line"><span class="comment"># enabled TLS</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_GENERAL_TLS_ENABLED=true</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/server.key</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/server.crt</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]</span></span><br><span class="line"><span class="comment"># TLS client</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_GENERAL_TLS_CLIENTAUTHREQUIRED=true</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_GENERAL_TLS_CLIENTROOTCAS=[/var/hyperledger/orderer/tls/ca.crt]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># enabled kafka client TLS</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_KAFKA_SERVER=kafkaserver</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_KAFKA_VERBOSE=true</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_KAFKA_TLS_ENABLED=true</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_KAFKA_TLS_PRIVATEKEY_FILE=/var/hyperledger/orderer/kafka/tls/client.key</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_KAFKA_TLS_CERTIFICATE_FILE=/var/hyperledger/orderer/kafka/tls/client.crt</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ORDERER_KAFKA_TLS_ROOTCAS_FILE=/var/hyperledger/orderer/kafka/tls/ca.crt</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># peer</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">CORE_PEER_TLS_ENABLED=true</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt</span></span><br><span class="line"><span class="comment"># TLS client</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">CORE_PEER_TLS_CLIENTAUTHREQUIRED=true</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">CORE_PEER_TLS_CLIENTROOTCAS_FILES=</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">CORE_PEER_TLS_CLIENTCERT_FILE=</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">CORE_PEER_TLS_CLIENTKEY_FILE=</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># CLI</span></span><br><span class="line"><span class="string">CORE_PEER_TLS_ENABLED</span> <span class="string">=</span> <span class="literal">true</span></span><br><span class="line"><span class="string">CORE_PEER_TLS_ROOTCERT_FILE=</span></span><br><span class="line"><span class="comment"># TLS client</span></span><br><span class="line"><span class="string">CORE_PEER_TLS_CLIENTAUTHREQUIRED</span> <span class="string">=</span> <span class="literal">true</span></span><br><span class="line"><span class="string">CORE_PEER_TLS_CLIENTCERT_FILE</span> <span class="string">=</span> </span><br><span class="line"><span class="string">CORE_PEER_TLS_CLIENTKEY_FILE</span> <span class="string">=</span></span><br></pre></td></tr></table></figure>

<h3 id="Generate-genesis-block"><a href="#Generate-genesis-block" class="headerlink" title="Generate genesis block"></a>Generate genesis block</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cryptogen	generate	--config=./crypto-config.yaml</span><br><span class="line"><span class="built_in">export</span>	FABRIC_CFG_PATH=<span class="variable">$PWD</span></span><br><span class="line">configtxgen -profile TwoOrgsOrdererGenesis -channelID byfn-sys-channel -outputBlock ./channel-artifacts/genesis.block</span><br><span class="line">configtxgen -profile SampleDevModeKafka -channelID byfn-sys-channel -outputBlock ./channel-artifacts/genesis.block</span><br></pre></td></tr></table></figure>

<h3 id="Configure-service-discovery-node-e-g-peer-and-orderer-addresses"><a href="#Configure-service-discovery-node-e-g-peer-and-orderer-addresses" class="headerlink" title="Configure service discovery node (e.g. peer and orderer addresses)"></a>Configure service discovery node (e.g. peer and orderer addresses)</h3><blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly9oeXBlcmxlZGdlci1mYWJyaWMucmVhZHRoZWRvY3MuaW8vZW4vcmVsZWFzZS0xLjQvZGlzY292ZXJ5LWNsaS5odG1s" title="https://hyperledger-fabric.readthedocs.io/en/release-1.4/discovery-cli.html">Docs » Commands Reference » Service Discovery CLI<i class="fa fa-external-link"></i></span></p>
</blockquote>
<p><code>CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer1.org1.example.com:8051</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">discover --configFile conf.yaml --peerTLSCA tls/ca.crt --userKey msp/keystore/ea4f6a38ac7057b6fa9502c2f5f39f182e320f71f667749100fe7dd94c23ce43_sk --userCert msp/signcerts/User1\@org1.example.com-cert.pem  --MSP Org1MSP saveConfig</span><br><span class="line"></span><br><span class="line"><span class="comment"># Peer membership query</span></span><br><span class="line">discover --configFile conf.yaml peers --channel mychannel  --server peer0.org1.example.com:7051</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configuration query</span></span><br><span class="line">discover --configFile conf.yaml config --channel mychannel  --server peer0.org1.example.com:7051</span><br><span class="line"><span class="comment"># certificates base64 decoded</span></span><br><span class="line">discover --configFile conf.yaml config --channel mychannel  --server peer0.org1.example.com:7051 | jq .msps.OrdererOrg.root_certs[0] | sed <span class="string">"s/\"//g"</span> | base64 --decode | openssl x509 -text -noout</span><br><span class="line"></span><br><span class="line"><span class="comment"># Endorsers query</span></span><br><span class="line">discover --configFile conf.yaml endorsers --channel mychannel  --server peer0.org1.example.com:7051 --chaincode mycc</span><br></pre></td></tr></table></figure>

<h2 id="Membership-Service-Provider-–-20"><a href="#Membership-Service-Provider-–-20" class="headerlink" title="Membership Service Provider – 20%"></a>Membership Service Provider – 20%</h2><h3 id="Configure-ACL"><a href="#Configure-ACL" class="headerlink" title="Configure ACL"></a>Configure ACL</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9oeXBlcmxlZGdlci1mYWJyaWMucmVhZHRoZWRvY3MuaW8vZW4vcmVsZWFzZS0xLjQvYWNjZXNzX2NvbnRyb2wuaHRtbA==" title="https://hyperledger-fabric.readthedocs.io/en/release-1.4/access_control.html">https://hyperledger-fabric.readthedocs.io/en/release-1.4/access_control.html<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2h5cGVybGVkZ2VyL2ZhYnJpYy9ibG9iL3JlbGVhc2UtMS4yL3NhbXBsZWNvbmZpZy9jb25maWd0eC55YW1s" title="https://github.com/hyperledger/fabric/blob/release-1.2/sampleconfig/configtx.yaml">https://github.com/hyperledger/fabric/blob/release-1.2/sampleconfig/configtx.yaml<i class="fa fa-external-link"></i></span></li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Application:</span> <span class="meta">&amp;ApplicationDefaults</span></span><br><span class="line"><span class="attr">    ACLs:</span> <span class="meta">&amp;ACLsDefault</span></span><br><span class="line">        <span class="comment"># This section provides defaults for policies for various resources</span></span><br><span class="line">        <span class="comment"># in the system. These "resources" could be functions on system chaincodes</span></span><br><span class="line">        <span class="comment"># (e.g., "GetBlockByNumber" on the "qscc" system chaincode) or other resources</span></span><br><span class="line">        <span class="comment"># (e.g.,who can receive Block events). This section does NOT specify the resource's</span></span><br><span class="line">        <span class="comment"># definition or API, but just the ACL policy for it.</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># User's can override these defaults with their own policy mapping by defining the</span></span><br><span class="line">        <span class="comment"># mapping under ACLs in their channel definition</span></span><br><span class="line">        <span class="comment">#---Lifecycle System Chaincode (lscc) function to policy mapping for access control---#</span></span><br><span class="line">        <span class="comment"># ACL policy for lscc's "getid" function</span></span><br><span class="line">        <span class="string">lscc/ChaincodeExists:</span> <span class="string">/Channel/Application/Readers</span></span><br><span class="line">        <span class="comment"># ACL policy for lscc's "getdepspec" function</span></span><br><span class="line">        <span class="string">lscc/GetDeploymentSpec:</span> <span class="string">/Channel/Application/Readers</span></span><br><span class="line">        <span class="comment"># ACL policy for lscc's "getccdata" function</span></span><br><span class="line">        <span class="string">lscc/GetChaincodeData:</span> <span class="string">/Channel/Application/Readers</span></span><br><span class="line">        <span class="comment"># ACL Policy for lscc's "getchaincodes" function</span></span><br><span class="line">        <span class="string">lscc/GetInstantiatedChaincodes:</span> <span class="string">/Channel/Application/Readers</span></span><br><span class="line">        <span class="comment">#---Query System Chaincode (qscc) function to policy mapping for access control---#</span></span><br><span class="line">        <span class="comment"># ACL policy for qscc's "GetChainInfo" function</span></span><br><span class="line">        <span class="string">qscc/GetChainInfo:</span> <span class="string">/Channel/Application/Readers</span></span><br><span class="line">        <span class="comment"># ACL policy for qscc's "GetBlockByNumber" function</span></span><br><span class="line">        <span class="string">qscc/GetBlockByNumber:</span> <span class="string">/Channel/Application/Readers</span></span><br><span class="line">        <span class="comment"># ACL policy for qscc's  "GetBlockByHash" function</span></span><br><span class="line">        <span class="string">qscc/GetBlockByHash:</span> <span class="string">/Channel/Application/Readers</span></span><br><span class="line">        <span class="comment"># ACL policy for qscc's "GetTransactionByID" function</span></span><br><span class="line">        <span class="string">qscc/GetTransactionByID:</span> <span class="string">/Channel/Application/Readers</span></span><br><span class="line">        <span class="comment"># ACL policy for qscc's "GetBlockByTxID" function</span></span><br><span class="line">        <span class="string">qscc/GetBlockByTxID:</span> <span class="string">/Channel/Application/Readers</span></span><br><span class="line">        <span class="comment">#---Configuration System Chaincode (cscc) function to policy mapping for access control---#</span></span><br><span class="line">        <span class="comment"># ACL policy for cscc's "GetConfigBlock" function</span></span><br><span class="line">        <span class="string">cscc/GetConfigBlock:</span> <span class="string">/Channel/Application/Readers</span></span><br><span class="line">        <span class="comment"># ACL policy for cscc's "GetConfigTree" function</span></span><br><span class="line">        <span class="string">cscc/GetConfigTree:</span> <span class="string">/Channel/Application/Readers</span></span><br><span class="line">        <span class="comment"># ACL policy for cscc's "SimulateConfigTreeUpdate" function</span></span><br><span class="line">        <span class="string">cscc/SimulateConfigTreeUpdate:</span> <span class="string">/Channel/Application/Readers</span></span><br><span class="line">        <span class="comment">#---Miscellanesous peer function to policy mapping for access control---#</span></span><br><span class="line">        <span class="comment"># ACL policy for invoking chaincodes on peer</span></span><br><span class="line">        <span class="string">peer/Propose:</span> <span class="string">/Channel/Application/Writers</span></span><br><span class="line">        <span class="comment"># ACL policy for chaincode to chaincode invocation</span></span><br><span class="line">        <span class="string">peer/ChaincodeToChaincode:</span> <span class="string">/Channel/Application/Readers</span></span><br><span class="line">        <span class="comment">#---Events resource to policy mapping for access control###---#</span></span><br><span class="line">        <span class="comment"># ACL policy for sending block events</span></span><br><span class="line">        <span class="string">event/Block:</span> <span class="string">/Channel/Application/Readers</span></span><br><span class="line">        <span class="comment"># ACL policy for sending filtered block events</span></span><br><span class="line">        <span class="string">event/FilteredBlock:</span> <span class="string">/Channel/Application/Readers</span></span><br><span class="line">    <span class="comment"># Organizations lists the orgs participating on the application side of the</span></span><br><span class="line">    <span class="comment"># network.</span></span><br><span class="line"><span class="attr">    Organizations:</span></span><br><span class="line">    <span class="comment"># Policies defines the set of policies at this level of the config tree</span></span><br><span class="line">    <span class="comment"># For Application policies, their canonical path is</span></span><br><span class="line">    <span class="comment">#   /Channel/Application/&lt;PolicyName&gt;</span></span><br><span class="line"><span class="attr">    Policies:</span> <span class="meta">&amp;ApplicationDefaultPolicies</span></span><br><span class="line"><span class="attr">        Readers:</span></span><br><span class="line"><span class="attr">            Type:</span> <span class="string">ImplicitMeta</span></span><br><span class="line"><span class="attr">            Rule:</span> <span class="string">"ANY Readers"</span></span><br><span class="line"><span class="attr">        Writers:</span></span><br><span class="line"><span class="attr">            Type:</span> <span class="string">ImplicitMeta</span></span><br><span class="line"><span class="attr">            Rule:</span> <span class="string">"ANY Writers"</span></span><br><span class="line"><span class="attr">        Admins:</span></span><br><span class="line"><span class="attr">            Type:</span> <span class="string">ImplicitMeta</span></span><br><span class="line"><span class="attr">            Rule:</span> <span class="string">"MAJORITY Admins"</span></span><br></pre></td></tr></table></figure>

<h3 id="Create-end-user-identity"><a href="#Create-end-user-identity" class="headerlink" title="Create end user identity"></a>Create end user identity</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> FABRIC_CA_CLIENT_HOME=<span class="variable">$HOME</span>/fabric-ca/clients/admin</span><br><span class="line">fabric-ca-client enroll -u http://admin:adminpw@localhost:7054</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> FABRIC_CA_CLIENT_HOME=<span class="variable">$HOME</span>/fabric-ca/clients/admin</span><br><span class="line">fabric-ca-client register --id.name admin2 --id.affiliation org1.department1 --id.attrs <span class="string">'hf.Revoker=true,admin=true:ecert'</span></span><br><span class="line"></span><br><span class="line">fabric-ca-client register -d --id.name admin2 --id.affiliation org1.department1 --id.attrs <span class="string">'"hf.Registrar.Roles=peer,client",hf.Revoker=true'</span></span><br><span class="line">fabric-ca-client register -d --id.name admin2 --id.affiliation org1.department1 --id.attrs <span class="string">'"hf.Registrar.Roles=peer,client"'</span> --id.attrs hf.Revoker=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> FABRIC_CA_CLIENT_HOME=<span class="variable">$HOME</span>/fabric-ca/clients/admin</span><br><span class="line">fabric-ca-client register --id.name peer1 --id.type peer --id.affiliation org1.department1 --id.secret peer1pw</span><br><span class="line">fabric-ca-client register --id.name client1 --id.type client --id.affiliation bu1.department1.Team1</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> FABRIC_CA_CLIENT_HOME=<span class="variable">$HOME</span>/fabric-ca/clients/peer1</span><br><span class="line">fabric-ca-client enroll -u http://peer1:peer1pw@localhost:7054 -M <span class="variable">$FABRIC_CA_CLIENT_HOME</span>/msp</span><br></pre></td></tr></table></figure>
<h3 id="Revoke-an-identity"><a href="#Revoke-an-identity" class="headerlink" title="Revoke an identity"></a>Revoke an identity</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">fabric-ca-client revoke -e &lt;enrollment_id&gt; -r &lt;reason&gt;</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> FABRIC_CA_CLIENT_HOME=<span class="variable">$HOME</span>/fabric-ca/clients/admin</span><br><span class="line">fabric-ca-client revoke -e peer1</span><br><span class="line"></span><br><span class="line">serial=$(openssl x509 -<span class="keyword">in</span> userecert.pem -serial -noout | cut -d <span class="string">"="</span> -f 2)</span><br><span class="line">aki=$(openssl x509 -<span class="keyword">in</span> userecert.pem -text | awk <span class="string">'/keyid/ &#123;gsub(/ *keyid:|:/,"",$1);print tolower($0)&#125;'</span>)</span><br><span class="line">fabric-ca-client revoke -s <span class="variable">$serial</span> -a <span class="variable">$aki</span> -r affiliationchange</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generating a CRL (Certificate Revocation List)</span></span><br><span class="line"><span class="built_in">export</span> FABRIC_CA_CLIENT_HOME=~/clientconfig</span><br><span class="line">fabric-ca-client gencrl -M ~/msp</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> FABRIC_CA_CLIENT_HOME=~/clientconfig</span><br><span class="line">fabric-ca-client gencrl --caname <span class="string">""</span> --revokedafter 2017-09-13T16:39:57-08:00 --revokedbefore 2017-09-21T16:39:57-08:00 -M ~/msp</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> FABRIC_CA_CLIENT_HOME=~/clientconfig</span><br><span class="line">fabric-ca-client gencrl --caname <span class="string">""</span> --expireafter 2017-09-13T16:39:57-08:00 --expirebefore 2018-09-13T16:39:57-08:00  --revokedafter 2017-09-13T16:39:57-08:00 --revokedbefore 2017-09-21T16:39:57-08:00 -M ~/msp</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Attribute-Based Access Control</p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fabric-ca-client register --id.name user1 --id.secret user1pw --id.type client --id.affiliation org1 --id.attrs <span class="string">'app1Admin=true:ecert,email=user1@gmail.com'</span></span><br><span class="line"></span><br><span class="line">fabric-ca-client enroll -u http://user1:user1pw@localhost:7054 --enrollment.attrs <span class="string">"email,phone:opt"</span></span><br><span class="line"></span><br><span class="line">fabric-ca-client register --id.name user1 --id.secret user1pw --id.type client --id.affiliation org1 --id.attrs <span class="string">'hf.Affiliation=org1:ecert'</span></span><br></pre></td></tr></table></figure>

<h3 id="Configure-and-start-Hyperledger-Fabric-CA"><a href="#Configure-and-start-Hyperledger-Fabric-CA" class="headerlink" title="Configure and start Hyperledger Fabric CA"></a>Configure and start Hyperledger Fabric CA</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9oeXBlcmxlZGdlci1mYWJyaWMtY2EucmVhZHRoZWRvY3MuaW8vZW4vcmVsZWFzZS0xLjQvc2VydmVyY29uZmlnLmh0bWw=" title="https://hyperledger-fabric-ca.readthedocs.io/en/release-1.4/serverconfig.html">https://hyperledger-fabric-ca.readthedocs.io/en/release-1.4/serverconfig.html<i class="fa fa-external-link"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9oeXBlcmxlZGdlci1mYWJyaWMtY2EucmVhZHRoZWRvY3MuaW8vZW4vcmVsZWFzZS0xLjQvY2xpZW50Y29uZmlnLmh0bWw=" title="https://hyperledger-fabric-ca.readthedocs.io/en/release-1.4/clientconfig.html">https://hyperledger-fabric-ca.readthedocs.io/en/release-1.4/clientconfig.html<i class="fa fa-external-link"></i></span><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="number">1.4</span><span class="number">.1</span></span><br><span class="line"><span class="attr">port:</span> <span class="number">7054</span></span><br><span class="line"><span class="attr">cors:</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">    origins:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"*"</span></span><br><span class="line"><span class="attr">debug:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">crlsizelimit:</span> <span class="number">512000</span></span><br><span class="line"><span class="attr">tls:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">  certfile:</span></span><br><span class="line"><span class="attr">  keyfile:</span></span><br><span class="line"><span class="attr">  clientauth:</span></span><br><span class="line"><span class="attr">    type:</span> <span class="string">noclientcert</span></span><br><span class="line"><span class="attr">    certfiles:</span></span><br><span class="line"><span class="attr">ca:</span></span><br><span class="line"><span class="attr">  name:</span></span><br><span class="line"><span class="attr">  keyfile:</span></span><br><span class="line"><span class="attr">  certfile:</span></span><br><span class="line"><span class="attr">  chainfile:</span></span><br><span class="line"><span class="attr">crl:</span></span><br><span class="line"><span class="attr">  expiry:</span> <span class="number">24</span><span class="string">h</span></span><br><span class="line"><span class="attr">registry:</span></span><br><span class="line"><span class="attr">  maxenrollments:</span> <span class="bullet">-1</span></span><br><span class="line"><span class="attr">  identities:</span></span><br><span class="line"><span class="attr">     - name:</span> <span class="string">admin</span></span><br><span class="line"><span class="attr">       pass:</span> <span class="string">adminpw</span></span><br><span class="line"><span class="attr">       type:</span> <span class="string">client</span></span><br><span class="line"><span class="attr">       affiliation:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">       attrs:</span></span><br><span class="line">          <span class="string">hf.Registrar.Roles:</span> <span class="string">"*"</span></span><br><span class="line">          <span class="string">hf.Registrar.DelegateRoles:</span> <span class="string">"*"</span></span><br><span class="line">          <span class="string">hf.Revoker:</span> <span class="literal">true</span></span><br><span class="line">          <span class="string">hf.IntermediateCA:</span> <span class="literal">true</span></span><br><span class="line">          <span class="string">hf.GenCRL:</span> <span class="literal">true</span></span><br><span class="line">          <span class="string">hf.Registrar.Attributes:</span> <span class="string">"*"</span></span><br><span class="line">          <span class="string">hf.AffiliationMgr:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">db:</span></span><br><span class="line"><span class="attr">  type:</span> <span class="string">sqlite3</span></span><br><span class="line"><span class="attr">  datasource:</span> <span class="string">fabric-ca-server.db</span></span><br><span class="line"><span class="attr">  tls:</span></span><br><span class="line"><span class="attr">      enabled:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">      certfiles:</span></span><br><span class="line"><span class="attr">      client:</span></span><br><span class="line"><span class="attr">        certfile:</span></span><br><span class="line"><span class="attr">        keyfile:</span></span><br><span class="line"><span class="attr">ldap:</span></span><br><span class="line"><span class="attr">   enabled:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">   url:</span> <span class="attr">ldap://&lt;adminDN&gt;:&lt;adminPassword&gt;@&lt;host&gt;:&lt;port&gt;/&lt;base&gt;</span></span><br><span class="line"><span class="attr">   tls:</span></span><br><span class="line"><span class="attr">      certfiles:</span></span><br><span class="line"><span class="attr">      client:</span></span><br><span class="line"><span class="attr">         certfile:</span></span><br><span class="line"><span class="attr">         keyfile:</span></span><br><span class="line"><span class="attr">   attribute:</span></span><br><span class="line"><span class="attr">      names:</span> <span class="string">['uid','member']</span></span><br><span class="line"><span class="attr">      converters:</span></span><br><span class="line"><span class="attr">         - name:</span></span><br><span class="line"><span class="attr">           value:</span></span><br><span class="line"><span class="attr">      maps:</span></span><br><span class="line"><span class="attr">         groups:</span></span><br><span class="line"><span class="attr">            - name:</span></span><br><span class="line"><span class="attr">              value:</span></span><br><span class="line"><span class="attr">affiliations:</span></span><br><span class="line"><span class="attr">   org1:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">department1</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">department2</span></span><br><span class="line"><span class="attr">   org2:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">department1</span></span><br><span class="line"><span class="attr">signing:</span></span><br><span class="line"><span class="attr">    default:</span></span><br><span class="line"><span class="attr">      usage:</span></span><br><span class="line"><span class="bullet">        -</span> <span class="string">digital</span> <span class="string">signature</span></span><br><span class="line"><span class="attr">      expiry:</span> <span class="number">8760</span><span class="string">h</span></span><br><span class="line"><span class="attr">    profiles:</span></span><br><span class="line"><span class="attr">      ca:</span></span><br><span class="line"><span class="attr">         usage:</span></span><br><span class="line"><span class="bullet">           -</span> <span class="string">cert</span> <span class="string">sign</span></span><br><span class="line"><span class="bullet">           -</span> <span class="string">crl</span> <span class="string">sign</span></span><br><span class="line"><span class="attr">         expiry:</span> <span class="number">43800</span><span class="string">h</span></span><br><span class="line"><span class="attr">         caconstraint:</span></span><br><span class="line"><span class="attr">           isca:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">           maxpathlen:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">      tls:</span></span><br><span class="line"><span class="attr">         usage:</span></span><br><span class="line"><span class="bullet">            -</span> <span class="string">signing</span></span><br><span class="line"><span class="bullet">            -</span> <span class="string">key</span> <span class="string">encipherment</span></span><br><span class="line"><span class="bullet">            -</span> <span class="string">server</span> <span class="string">auth</span></span><br><span class="line"><span class="bullet">            -</span> <span class="string">client</span> <span class="string">auth</span></span><br><span class="line"><span class="bullet">            -</span> <span class="string">key</span> <span class="string">agreement</span></span><br><span class="line"><span class="attr">         expiry:</span> <span class="number">8760</span><span class="string">h</span></span><br><span class="line"><span class="attr">csr:</span></span><br><span class="line"><span class="attr">   cn:</span> <span class="string">fabric-ca-server</span></span><br><span class="line"><span class="attr">   keyrequest:</span></span><br><span class="line"><span class="attr">     algo:</span> <span class="string">ecdsa</span></span><br><span class="line"><span class="attr">     size:</span> <span class="number">256</span></span><br><span class="line"><span class="attr">   names:</span></span><br><span class="line"><span class="attr">      - C:</span> <span class="string">US</span></span><br><span class="line"><span class="attr">        ST:</span> <span class="string">"North Carolina"</span></span><br><span class="line"><span class="attr">        L:</span></span><br><span class="line"><span class="attr">        O:</span> <span class="string">Hyperledger</span></span><br><span class="line"><span class="attr">        OU:</span> <span class="string">Fabric</span></span><br><span class="line"><span class="attr">   hosts:</span></span><br><span class="line"><span class="bullet">     -</span> <span class="string">db1216d39a1d</span></span><br><span class="line"><span class="bullet">     -</span> <span class="string">localhost</span></span><br><span class="line"><span class="attr">   ca:</span></span><br><span class="line"><span class="attr">      expiry:</span> <span class="number">131400</span><span class="string">h</span></span><br><span class="line"><span class="attr">      pathlength:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">idemix:</span></span><br><span class="line"><span class="attr">  rhpoolsize:</span> <span class="number">1000</span></span><br><span class="line"><span class="attr">  nonceexpiration:</span> <span class="number">15</span><span class="string">s</span></span><br><span class="line"><span class="attr">  noncesweepinterval:</span> <span class="number">15</span><span class="string">m</span></span><br><span class="line"><span class="attr">bccsp:</span></span><br><span class="line"><span class="attr">    default:</span> <span class="string">SW</span></span><br><span class="line"><span class="attr">    sw:</span></span><br><span class="line"><span class="attr">        hash:</span> <span class="string">SHA2</span></span><br><span class="line"><span class="attr">        security:</span> <span class="number">256</span></span><br><span class="line"><span class="attr">        filekeystore:</span></span><br><span class="line"><span class="attr">            keystore:</span> <span class="string">msp/keystore</span></span><br><span class="line"><span class="attr">cacount:</span></span><br><span class="line"><span class="attr">cafiles:</span></span><br><span class="line"><span class="attr">intermediate:</span></span><br><span class="line"><span class="attr">  parentserver:</span></span><br><span class="line"><span class="attr">    url:</span></span><br><span class="line"><span class="attr">    caname:</span></span><br><span class="line"><span class="attr">  enrollment:</span></span><br><span class="line"><span class="attr">    hosts:</span></span><br><span class="line"><span class="attr">    profile:</span></span><br><span class="line"><span class="attr">    label:</span></span><br><span class="line"><span class="attr">  tls:</span></span><br><span class="line"><span class="attr">    certfiles:</span></span><br><span class="line"><span class="attr">    client:</span></span><br><span class="line"><span class="attr">      certfile:</span></span><br><span class="line"><span class="attr">      keyfile:</span></span><br><span class="line"><span class="attr">cfg:</span></span><br><span class="line"><span class="attr">  identities:</span></span><br><span class="line"><span class="attr">    passwordattempts:</span> <span class="number">10</span></span><br><span class="line"><span class="attr">operations:</span></span><br><span class="line"><span class="attr">    listenAddress:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:9443</span></span><br><span class="line"><span class="attr">    tls:</span></span><br><span class="line"><span class="attr">        enabled:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">        cert:</span></span><br><span class="line"><span class="attr">            file:</span></span><br><span class="line"><span class="attr">        key:</span></span><br><span class="line"><span class="attr">            file:</span></span><br><span class="line"><span class="attr">        clientAuthRequired:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">        clientRootCAs:</span></span><br><span class="line"><span class="attr">            files:</span> <span class="string">[]</span></span><br><span class="line"><span class="attr">metrics:</span></span><br><span class="line"><span class="attr">    provider:</span> <span class="string">disabled</span></span><br><span class="line"><span class="attr">    statsd:</span></span><br><span class="line"><span class="attr">        network:</span> <span class="string">udp</span></span><br><span class="line"><span class="attr">        address:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:8125</span></span><br><span class="line"><span class="attr">        writeInterval:</span> <span class="number">10</span><span class="string">s</span></span><br><span class="line"><span class="attr">        prefix:</span> <span class="string">server</span></span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cn:</span> <span class="string">fabric-ca-server</span></span><br><span class="line"><span class="attr">names:</span></span><br><span class="line"><span class="attr">   - C:</span> <span class="string">US</span></span><br><span class="line"><span class="attr">     ST:</span> <span class="string">"North Carolina"</span></span><br><span class="line"><span class="attr">     L:</span></span><br><span class="line"><span class="attr">     O:</span> <span class="string">Hyperledger</span></span><br><span class="line"><span class="attr">     OU:</span> <span class="string">Fabric</span></span><br><span class="line"><span class="attr">hosts:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">host1.example.com</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">localhost</span></span><br><span class="line"><span class="attr">ca:</span></span><br><span class="line"><span class="attr">   expiry:</span> <span class="number">131400</span><span class="string">h</span></span><br><span class="line"><span class="attr">   pathlength:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>


</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fabric-ca-server init -b admin:adminpw</span><br><span class="line">fabric-ca-server start -b &lt;admin&gt;:&lt;adminpw&gt;</span><br><span class="line">fabric-ca-server start -b admin:adminpw --cfg.affiliations.allowremove --cfg.identities.allowremove</span><br></pre></td></tr></table></figure>

<h3 id="Configure-Hyperledger-Fabric-for-hardware-security-module"><a href="#Configure-Hyperledger-Fabric-for-hardware-security-module" class="headerlink" title="Configure Hyperledger Fabric for hardware security module"></a>Configure Hyperledger Fabric for hardware security module</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#############################################################################</span></span><br><span class="line"><span class="comment"># BCCSP (BlockChain Crypto Service Provider) section is used to select which</span></span><br><span class="line"><span class="comment"># crypto library implementation to use</span></span><br><span class="line"><span class="comment">#############################################################################</span></span><br><span class="line"><span class="attr">bccsp:</span></span><br><span class="line"><span class="attr">  default:</span> <span class="string">PKCS11</span></span><br><span class="line"><span class="attr">  pkcs11:</span></span><br><span class="line"><span class="attr">    Library:</span> <span class="string">/usr/local/Cellar/softhsm/2.1.0/lib/softhsm/libsofthsm2.so</span></span><br><span class="line"><span class="attr">    Pin:</span> <span class="number">98765432</span></span><br><span class="line"><span class="attr">    Label:</span> <span class="string">ForFabric</span></span><br><span class="line"><span class="attr">    hash:</span> <span class="string">SHA2</span></span><br><span class="line"><span class="attr">    security:</span> <span class="number">256</span></span><br><span class="line"><span class="attr">    filekeystore:</span></span><br><span class="line">      <span class="comment"># The directory used for the software file-based keystore</span></span><br><span class="line"><span class="attr">      keystore:</span> <span class="string">msp/keystore</span></span><br></pre></td></tr></table></figure>

<h2 id="Network-Maintenance-and-Operations-–-20"><a href="#Network-Maintenance-and-Operations-–-20" class="headerlink" title="Network Maintenance and Operations – 20%"></a>Network Maintenance and Operations – 20%</h2><h3 id="Add-a-peer-to-existing-organization"><a href="#Add-a-peer-to-existing-organization" class="headerlink" title="Add a peer to existing organization"></a>Add a peer to existing organization</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem &amp;&amp; <span class="built_in">export</span> CHANNEL_NAME=mychannel</span><br><span class="line">peer channel fetch 0 mychannel.block -o orderer.example.com:7050 -c <span class="variable">$CHANNEL_NAME</span> --tls --cafile <span class="variable">$ORDERER_CA</span></span><br><span class="line">peer channel join -b <span class="variable">$CHANNEL_NAME</span>.block</span><br></pre></td></tr></table></figure>
<h3 id="Create-a-channel"><a href="#Create-a-channel" class="headerlink" title="Create a channel"></a>Create a channel</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9oeXBlcmxlZGdlci1mYWJyaWMucmVhZHRoZWRvY3MuaW8vZW4vcmVsZWFzZS0xLjQvYnVpbGRfbmV0d29yay5odG1s" title="https://hyperledger-fabric.readthedocs.io/en/release-1.4/build_network.html">Docs » Tutorials » Building Your First Network<i class="fa fa-external-link"></i></span></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp</span><br><span class="line">CORE_PEER_ADDRESS=peer0.org1.example.com:7051</span><br><span class="line">CORE_PEER_LOCALMSPID=<span class="string">"Org1MSP"</span></span><br><span class="line">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt</span><br><span class="line"></span><br><span class="line">peer channel create -o orderer.example.com:7050 -c <span class="variable">$CHANNEL_NAME</span> -f ./channel-artifacts/channel.tx</span><br><span class="line">peer channel create -o orderer.example.com:7050 -c <span class="variable">$CHANNEL_NAME</span> -f ./channel-artifacts/channel.tx --tls <span class="variable">$CORE_PEER_TLS_ENABLED</span> --cafile</span><br><span class="line">peer channel join -b <span class="variable">$CHANNEL_NAME</span>.block</span><br><span class="line">peer channel list &amp;&gt;channel-list.txt</span><br></pre></td></tr></table></figure>
<h3 id="Add-an-org-to-a-channel"><a href="#Add-an-org-to-a-channel" class="headerlink" title="Add an org to a channel"></a>Add an org to a channel</h3><p><span class="exturl" data-url="aHR0cHM6Ly9oeXBlcmxlZGdlci1mYWJyaWMucmVhZHRoZWRvY3MuaW8vZW4vcmVsZWFzZS0xLjQvY2hhbm5lbF91cGRhdGVfdHV0b3JpYWwuaHRtbA==" title="https://hyperledger-fabric.readthedocs.io/en/release-1.4/channel_update_tutorial.html">Docs » Tutorials » Adding an Org to a Channel<i class="fa fa-external-link"></i></span></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> org3-artifacts</span><br><span class="line">../../bin/cryptogen generate --config=./org3-crypto.yaml</span><br><span class="line"><span class="built_in">export</span> FABRIC_CFG_PATH=<span class="variable">$PWD</span> &amp;&amp; ../../bin/configtxgen -printOrg Org3MSP &gt; ../channel-artifacts/org3.json</span><br><span class="line"><span class="built_in">cd</span> ../ &amp;&amp; cp -r crypto-config/ordererOrganizations org3-artifacts/crypto-config/</span><br><span class="line"></span><br><span class="line">docker <span class="built_in">exec</span> -it cli bash</span><br><span class="line"><span class="built_in">export</span> ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem  &amp;&amp; <span class="built_in">export</span> CHANNEL_NAME=mychannel</span><br><span class="line">peer channel fetch config config_block.pb -o orderer.example.com:7050 -c <span class="variable">$CHANNEL_NAME</span> --tls --cafile <span class="variable">$ORDERER_CA</span></span><br><span class="line"></span><br><span class="line">configtxlator proto_decode --input config_block.pb --<span class="built_in">type</span> common.Block | jq .data.data[0].payload.data.config &gt; config.json</span><br><span class="line"></span><br><span class="line">jq -s <span class="string">'.[0] * &#123;"channel_group":&#123;"groups":&#123;"Application":&#123;"groups": &#123;"Org3MSP":.[1]&#125;&#125;&#125;&#125;&#125;'</span> config.json ./channel-artifacts/org3.json &gt; modified_config.json</span><br><span class="line">configtxlator proto_encode --input config.json --<span class="built_in">type</span> common.Config --output config.pb</span><br><span class="line">configtxlator proto_encode --input modified_config.json --<span class="built_in">type</span> common.Config --output modified_config.pb</span><br><span class="line">configtxlator compute_update --channel_id <span class="variable">$CHANNEL_NAME</span> --original config.pb --updated modified_config.pb --output org3_update.pb</span><br><span class="line">configtxlator proto_decode --input org3_update.pb --<span class="built_in">type</span> common.ConfigUpdate | jq . &gt; org3_update.json</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'&#123;"payload":&#123;"header":&#123;"channel_header":&#123;"channel_id":"'</span><span class="variable">$CHANNEL_NAME</span><span class="string">'", "type":2&#125;&#125;,"data":&#123;"config_update":'</span>$(cat org3_update.json)<span class="string">'&#125;&#125;&#125;'</span> | jq . &gt; org3_update_in_envelope.json</span><br><span class="line">configtxlator proto_encode --input org3_update_in_envelope.json --<span class="built_in">type</span> common.Envelope --output org3_update_in_envelope.pb</span><br><span class="line"></span><br><span class="line">peer channel signconfigtx -f org3_update_in_envelope.pb</span><br><span class="line"></span><br><span class="line"><span class="comment"># you can issue all of these commands at once</span></span><br><span class="line"><span class="built_in">export</span> CORE_PEER_LOCALMSPID=<span class="string">"Org2MSP"</span></span><br><span class="line"><span class="built_in">export</span> CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt</span><br><span class="line"><span class="built_in">export</span> CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp</span><br><span class="line"><span class="built_in">export</span> CORE_PEER_ADDRESS=peer0.org2.example.com:9051</span><br><span class="line"></span><br><span class="line">peer channel update -f org3_update_in_envelope.pb -c <span class="variable">$CHANNEL_NAME</span> -o orderer.example.com:7050 --tls --cafile <span class="variable">$ORDERER_CA</span></span><br><span class="line"></span><br><span class="line">docker-compose -f docker-compose-org3.yaml up -d</span><br><span class="line">docker <span class="built_in">exec</span> -it Org3cli bash</span><br><span class="line"><span class="built_in">export</span> ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem &amp;&amp; <span class="built_in">export</span> CHANNEL_NAME=mychannel</span><br><span class="line">peer channel fetch 0 mychannel.block -o orderer.example.com:7050 -c <span class="variable">$CHANNEL_NAME</span> --tls --cafile <span class="variable">$ORDERER_CA</span></span><br><span class="line">peer channel join -b mychannel.block</span><br><span class="line"><span class="comment"># switch peer1.org3</span></span><br><span class="line"><span class="built_in">export</span> CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/peers/peer1.org3.example.com/tls/ca.crt &amp;&amp; <span class="built_in">export</span> CORE_PEER_ADDRESS=peer1.org3.example.com:12051</span><br><span class="line">peer channel join -b mychannel.block</span><br></pre></td></tr></table></figure>

<h3 id="Update-channel-configuration"><a href="#Update-channel-configuration" class="headerlink" title="Update channel configuration"></a>Update channel configuration</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9oeXBlcmxlZGdlci1mYWJyaWMucmVhZHRoZWRvY3MuaW8vZW4vcmVsZWFzZS0xLjQvY29uZmlnX3VwZGF0ZS5odG1s" title="https://hyperledger-fabric.readthedocs.io/en/release-1.4/config_update.html">Docs » Operations Guides » Updating a Channel Configuration<i class="fa fa-external-link"></i></span><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> MAXBATCHSIZEPATH=<span class="string">".channel_group.groups.Orderer.values.BatchSize.value.max_message_count"</span></span><br><span class="line">jq <span class="string">"<span class="variable">$MAXBATCHSIZEPATH</span>"</span> config.json</span><br><span class="line">jq <span class="string">"<span class="variable">$MAXBATCHSIZEPATH</span> = 20"</span> config.json &gt; modified_config.json</span><br><span class="line">jq <span class="string">"<span class="variable">$MAXBATCHSIZEPATH</span>"</span> modified_config.json</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get the Necessary Signatures</span></span><br><span class="line"><span class="built_in">export</span> CORE_PEER_LOCALMSPID=<span class="string">"OrdererMSP"</span></span><br><span class="line"><span class="built_in">export</span> CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/tls/ca.crt</span><br><span class="line"><span class="built_in">export</span> CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/users/Admin@example.com/msp/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">peer channel signconfigtx -f</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="Update-a-Hyperledger-Fabric-Instance"><a href="#Update-a-Hyperledger-Fabric-Instance" class="headerlink" title="Update a Hyperledger Fabric Instance"></a>Update a Hyperledger Fabric Instance</h3><p><span class="exturl" data-url="aHR0cHM6Ly9oeXBlcmxlZGdlci1mYWJyaWMucmVhZHRoZWRvY3MuaW8vZW4vcmVsZWFzZS0xLjQvdXBncmFkaW5nX3lvdXJfbmV0d29ya190dXRvcmlhbC5odG1s" title="https://hyperledger-fabric.readthedocs.io/en/release-1.4/upgrading_your_network_tutorial.html">Docs » Tutorials » Upgrading Your Network Components<i class="fa fa-external-link"></i></span></p>
<ol>
<li>Clean up<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./byfn.sh down</span><br></pre></td></tr></table></figure></li>
<li>Generate the crypto and bring up the network<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git fetch origin</span><br><span class="line"></span><br><span class="line">git checkout v1.3.0</span><br><span class="line"></span><br><span class="line">./byfn.sh generate</span><br><span class="line"></span><br><span class="line">./byfn.sh up -t 3000 -i 1.3.0</span><br></pre></td></tr></table></figure></li>
<li>Get the newest samples<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout v1.4.1</span><br></pre></td></tr></table></figure></li>
<li>Upgrade the orderer containers<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> CH_NAME=testchainid</span><br><span class="line"></span><br><span class="line">docker stop orderer.example.com</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> LEDGERS_BACKUP=./ledgers-backup</span><br><span class="line"><span class="built_in">export</span> IMAGE_TAG=$(go env GOARCH)-1.4.1</span><br><span class="line"></span><br><span class="line">mkdir -p <span class="variable">$LEDGERS_BACKUP</span></span><br><span class="line"></span><br><span class="line">docker cp orderer.example.com:/var/hyperledger/production/orderer/ ./<span class="variable">$LEDGERS_BACKUP</span>/orderer.example.com</span><br><span class="line"></span><br><span class="line">docker-compose -f docker-compose-cli.yaml up -d --no-deps orderer.example.com</span><br></pre></td></tr></table></figure></li>
<li>Upgrade the peer containers<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docker stop peer0.org1.example.com</span><br><span class="line">mkdir -p <span class="variable">$LEDGERS_BACKUP</span></span><br><span class="line"></span><br><span class="line">docker cp <span class="variable">$PEER</span>:/var/hyperledger/production ./<span class="variable">$LEDGERS_BACKUP</span>/<span class="variable">$PEER</span></span><br><span class="line"></span><br><span class="line">CC_CONTAINERS=$(docker ps | grep dev-<span class="variable">$PEER</span> | awk <span class="string">'&#123;print $1&#125;'</span>)</span><br><span class="line"><span class="keyword">if</span> [ -n <span class="string">"<span class="variable">$CC_CONTAINERS</span>"</span> ] ; <span class="keyword">then</span> docker rm -f <span class="variable">$CC_CONTAINERS</span> ; <span class="keyword">fi</span></span><br><span class="line">CC_IMAGES=$(docker images | grep dev-<span class="variable">$PEER</span> | awk <span class="string">'&#123;print $1&#125;'</span>)</span><br><span class="line"><span class="keyword">if</span> [ -n <span class="string">"<span class="variable">$CC_IMAGES</span>"</span> ] ; <span class="keyword">then</span> docker rmi -f <span class="variable">$CC_IMAGES</span> ; <span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">docker-compose -f docker-compose-cli.yaml up -d --no-deps <span class="variable">$PEER</span></span><br></pre></td></tr></table></figure></li>
<li>Verify peer upgrade completion<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">docker-compose -f docker-compose-cli.yaml stop cli</span><br><span class="line"></span><br><span class="line">docker-compose -f docker-compose-cli.yaml up -d --no-deps cli</span><br><span class="line"></span><br><span class="line">CH_NAME=mychannel</span><br><span class="line">ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem</span><br><span class="line"></span><br><span class="line">peer chaincode invoke -o orderer.example.com:7050 --peerAddresses peer0.org1.example.com:7051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt --peerAddresses peer0.org2.example.com:9051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt --tls --cafile <span class="variable">$ORDERER_CA</span> -C <span class="variable">$CH_NAME</span> -n mycc -c <span class="string">'&#123;"Args":["invoke","a","b","10"]&#125;'</span></span><br><span class="line"></span><br><span class="line">peer chaincode query -C mychannel -n mycc -c <span class="string">'&#123;"Args":["query","a"]&#125;'</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="Diagnostics-and-Troubleshooting-–-15"><a href="#Diagnostics-and-Troubleshooting-–-15" class="headerlink" title="Diagnostics and Troubleshooting – 15%"></a>Diagnostics and Troubleshooting – 15%</h2><h3 id="Query-and-analyse-peer-logs"><a href="#Query-and-analyse-peer-logs" class="headerlink" title="Query and analyse peer logs"></a>Query and analyse peer logs</h3><h3 id="Query-and-analyse-CA-logs"><a href="#Query-and-analyse-CA-logs" class="headerlink" title="Query and analyse CA logs"></a>Query and analyse CA logs</h3><h3 id="Query-and-analyse-Orderer-logs"><a href="#Query-and-analyse-Orderer-logs" class="headerlink" title="Query and analyse Orderer logs"></a>Query and analyse Orderer logs</h3><h3 id="Query-and-analyse-chaincode-logs"><a href="#Query-and-analyse-chaincode-logs" class="headerlink" title="Query and analyse chaincode logs"></a>Query and analyse chaincode logs</h3><h1 id="CHFA-Environment"><a href="#CHFA-Environment" class="headerlink" title="CHFA Environment"></a>CHFA Environment</h1><ul>
<li>Each task on this exam must be completed on a designated Fabric node, most of which run<br>Fabric under ​docker/docker-compose​.</li>
<li>Most​ of the networks are based off of ​byfn​ with configuration files located under <code>/srv/fabric-samples​</code>, unless otherwise noted in the instructions.</li>
<li>For most tasks, you can connect to the CLI node with a command such as:<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it cli bash</span><br></pre></td></tr></table></figure></li>
<li>At the start of each task, you will be directed to which Fabric node you should ​ssh​ to in order to complete the task.</li>
<li>You can ssh to a Fabric node with a command such as:<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh fabadm@&lt;nodename&gt;</span><br></pre></td></tr></table></figure></li>
<li>The ​fabadm​ user should be used for all tasks, unless otherwise indicated.</li>
<li>You can assume elevated privileges on any node by issuing the following command:<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -i</span><br></pre></td></tr></table></figure></li>
<li>You can also use ​sudo​ to execute commands with elevated privileges at any time.</li>
<li>You must return to the base node (hostname ​node-1​) after completing each task.</li>
<li>The exam is based on Fabric v1.4</li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul>
<li>官网： <span class="exturl" data-url="aHR0cHM6Ly90cmFpbmluZy5saW51eGZvdW5kYXRpb24ub3JnL2NlcnRpZmljYXRpb24vY2VydGlmaWVkLWh5cGVybGVkZ2VyLWZhYnJpYy1hZG1pbmlzdHJhdG9yLWNoZmEv" title="https://training.linuxfoundation.org/certification/certified-hyperledger-fabric-administrator-chfa/">https://training.linuxfoundation.org/certification/certified-hyperledger-fabric-administrator-chfa/<i class="fa fa-external-link"></i></span></li>
<li>fabric 文档： <span class="exturl" data-url="aHR0cHM6Ly9oeXBlcmxlZGdlci1mYWJyaWMucmVhZHRoZWRvY3MuaW8vZW4vcmVsZWFzZS0xLjQvdHV0b3JpYWxzLmh0bWw=" title="https://hyperledger-fabric.readthedocs.io/en/release-1.4/tutorials.html">https://hyperledger-fabric.readthedocs.io/en/release-1.4/tutorials.html<i class="fa fa-external-link"></i></span></li>
<li>fabric-ca 文档： <span class="exturl" data-url="aHR0cHM6Ly9oeXBlcmxlZGdlci1mYWJyaWMtY2EucmVhZHRoZWRvY3MuaW8vZW4vcmVsZWFzZS0xLjQvdXNlcnMtZ3VpZGUuaHRtbA==" title="https://hyperledger-fabric-ca.readthedocs.io/en/release-1.4/users-guide.html">https://hyperledger-fabric-ca.readthedocs.io/en/release-1.4/users-guide.html<i class="fa fa-external-link"></i></span></li>
</ul>

    </div>

    
    
    
        <div class="reward-container">
  <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="https://upyun.hoke58.cn/hoke/wechatpay.png" alt="Hoke 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="https://upyun.hoke58.cn/hoke/alipay.png" alt="Hoke 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Hoke
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://blog.hoke58.cn/blockchain/undefined.html" title="Certified Hyperledger Fabric Administrator（CHFA）备考笔记">https://blog.hoke58.cn/blockchain/undefined.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/Hyperledger/" rel="tag"><i class="fa fa-tag"></i> Hyperledger</a>
              <a href="/tags/CHFA/" rel="tag"><i class="fa fa-tag"></i> CHFA</a>
              <a href="/tags/Fabric/" rel="tag"><i class="fa fa-tag"></i> Fabric</a>
              <a href="/tags/fabric-ca/" rel="tag"><i class="fa fa-tag"></i> fabric-ca</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/blockchain/hyperledger-fabric-discover.html" rel="prev" title="Hyperledger Fabric 扫盲之 Service Discovery CLI">
      <i class="fa fa-chevron-left"></i> Hyperledger Fabric 扫盲之 Service Discovery CLI
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#CHFA-介绍"><span class="nav-number">1.</span> <span class="nav-text">CHFA 介绍</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#备考笔记"><span class="nav-number">2.</span> <span class="nav-text">备考笔记</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Application-Lifecycle-Management-–-20"><span class="nav-number">2.1.</span> <span class="nav-text">Application Lifecycle Management – 20%</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Install-and-Instantiate-chaincode-package"><span class="nav-number">2.1.1.</span> <span class="nav-text">Install and Instantiate chaincode package</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Configure-endorsement-policy"><span class="nav-number">2.1.2.</span> <span class="nav-text">Configure endorsement policy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Define-collection-policy-for-private-data"><span class="nav-number">2.1.3.</span> <span class="nav-text">Define collection policy for private data</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Modify-or-upgrade-chaincode"><span class="nav-number">2.1.4.</span> <span class="nav-text">Modify or upgrade chaincode</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Install-and-Configure-Network-–-25"><span class="nav-number">2.2.</span> <span class="nav-text">Install and Configure Network – 25%</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Modify-the-world-state-database-configuration"><span class="nav-number">2.2.1.</span> <span class="nav-text">Modify the world state database configuration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Define-initial-multi-org-configuration-policy"><span class="nav-number">2.2.2.</span> <span class="nav-text">Define initial multi-org configuration policy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Configure-Ordering-service-Kafka"><span class="nav-number">2.2.3.</span> <span class="nav-text">Configure Ordering service (Kafka)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Configure-Hyperledger-Fabric-containers"><span class="nav-number">2.2.4.</span> <span class="nav-text">Configure Hyperledger Fabric containers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Define-network-config-options-block-creation-options-etc"><span class="nav-number">2.2.5.</span> <span class="nav-text">Define network config options (block creation options, etc)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Enable-TLS-for-communication"><span class="nav-number">2.2.6.</span> <span class="nav-text">Enable TLS for communication</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Generate-genesis-block"><span class="nav-number">2.2.7.</span> <span class="nav-text">Generate genesis block</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Configure-service-discovery-node-e-g-peer-and-orderer-addresses"><span class="nav-number">2.2.8.</span> <span class="nav-text">Configure service discovery node (e.g. peer and orderer addresses)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Membership-Service-Provider-–-20"><span class="nav-number">2.3.</span> <span class="nav-text">Membership Service Provider – 20%</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Configure-ACL"><span class="nav-number">2.3.1.</span> <span class="nav-text">Configure ACL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-end-user-identity"><span class="nav-number">2.3.2.</span> <span class="nav-text">Create end user identity</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Revoke-an-identity"><span class="nav-number">2.3.3.</span> <span class="nav-text">Revoke an identity</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Configure-and-start-Hyperledger-Fabric-CA"><span class="nav-number">2.3.4.</span> <span class="nav-text">Configure and start Hyperledger Fabric CA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Configure-Hyperledger-Fabric-for-hardware-security-module"><span class="nav-number">2.3.5.</span> <span class="nav-text">Configure Hyperledger Fabric for hardware security module</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Network-Maintenance-and-Operations-–-20"><span class="nav-number">2.4.</span> <span class="nav-text">Network Maintenance and Operations – 20%</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Add-a-peer-to-existing-organization"><span class="nav-number">2.4.1.</span> <span class="nav-text">Add a peer to existing organization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-a-channel"><span class="nav-number">2.4.2.</span> <span class="nav-text">Create a channel</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Add-an-org-to-a-channel"><span class="nav-number">2.4.3.</span> <span class="nav-text">Add an org to a channel</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Update-channel-configuration"><span class="nav-number">2.4.4.</span> <span class="nav-text">Update channel configuration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Update-a-Hyperledger-Fabric-Instance"><span class="nav-number">2.4.5.</span> <span class="nav-text">Update a Hyperledger Fabric Instance</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Diagnostics-and-Troubleshooting-–-15"><span class="nav-number">2.5.</span> <span class="nav-text">Diagnostics and Troubleshooting – 15%</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Query-and-analyse-peer-logs"><span class="nav-number">2.5.1.</span> <span class="nav-text">Query and analyse peer logs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Query-and-analyse-CA-logs"><span class="nav-number">2.5.2.</span> <span class="nav-text">Query and analyse CA logs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Query-and-analyse-Orderer-logs"><span class="nav-number">2.5.3.</span> <span class="nav-text">Query and analyse Orderer logs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Query-and-analyse-chaincode-logs"><span class="nav-number">2.5.4.</span> <span class="nav-text">Query and analyse chaincode logs</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CHFA-Environment"><span class="nav-number">3.</span> <span class="nav-text">CHFA Environment</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reference"><span class="nav-number">4.</span> <span class="nav-text">Reference</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hoke"
      src="https://upyun.hoke58.cn/hoke/hoke_avatar.png">
  <p class="site-author-name" itemprop="name">Hoke</p>
  <div class="site-description" itemprop="description">一名追求简单实用的运维开发工程师</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">25</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">38</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2hva2U1OA==" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hoke58"><i class="fa fa-fw fa-github"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOmhva2U1OEBxcS5jb20=" title="E-Mail → mailto:hoke58@qq.com"><i class="fa fa-fw fa-envelope"></i>E-Mail</span>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>
    <footer class="footer">
      <div class="footer-inner">
        
  <div class="beian"><span class="exturl" data-url="aHR0cDovL3d3dy5iZWlhbi5taWl0Lmdvdi5jbg==">苏ICP备19062979号 </span>
      <img src="https://upyun.hoke58.cn/hoke/备案图标.png" style="display: inline-block;"><span class="exturl" data-url="aHR0cDovL3d3dy5iZWlhbi5nb3YuY24vcG9ydGFsL3JlZ2lzdGVyU3lzdGVtSW5mbz9yZWNvcmRjb2RlPTMyMDExNDAyMDEwNTk2">苏公网安备 32011402010596号 </span>
  </div>

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heartbeat"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hoke</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="站点总字数">241k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">3:39</span>
</div>
  <div class="powered-by">由 <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span>  v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <span class="exturl theme-link" data-url="aHR0cHM6Ly9taXN0LnRoZW1lLW5leHQub3Jn">NexT.Mist</span> v7.7.2
  </div>
  <span class="post-meta-divider">|</span>
  <div class="cdn-by">
  <span style="display: inline-block;vertical-align: middle;">CDN 加速</span>
  <a class="theme-link" href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" title="又拍云提供 CDN 服务" rel="external nofollow noopener noreferrer" target="_blank" style="display: inline-block;border: none;vertical-align: middle;"><img src="https://upyun.hoke58.cn/upyun/%E5%8F%88%E6%8B%8D%E4%BA%91_logo5.png" style="width:50px"></a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : true,
      appId      : '673lhPxhfzi9igdgEAffu3EE-gzGzoHsz',
      appKey     : 'Ru4kkS1IQa0YUBA40l2P6H22',
      placeholder: "来说两句吧",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : 'https://leancloud.hoke58.cn'
    });
  }, window.Valine);
});
</script>

</body>
</html>
